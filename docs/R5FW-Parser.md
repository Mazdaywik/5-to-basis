Библиотека `R5FW-Parser`
========================

Лексический анализатор для Рефала-5
-----------------------------------

Лексический анализатор для Рефала-5, для указанного файла формирует
последовательность токенов.

    <Scan e.SourceFile> == t.Token*
    t.Pos ::= (s.Line s.Col e.FileName)

Возвращает последовательность токенов для данного файла. Тип `t.Token`
описан в [`R5FW-Parser-Defs`](R5FW-Parser-Defs.md).

Позиция в исходном тексте, формируемая лексическим анализатором, содержит
номер колонки, строки и имя файла.

**Замечание.** Разбор токена `TkMacroDigit` зависит от используемой реализации
Рефала-5.

* При использовании 32-разрядных `refc` и `refgo` или Рефала-5λ любой
  разрядности, допустимый диапазон чисел лежит от 0 до 2<sup>32</sup>−1.
  Если в исходном тексте записана макроцифра, значение которой выходит за эти
  границы, будет сформировано сообщение об ошибке (токен `TkError`).
* При использовании 64-разрядных `refc` и `refgo` диапазон ограничен,
  соответственно, 0…2<sup>64</sup>−1. При выходе за границы тоже будет
  сформирован `TkError`.
* При использовании Рефала-05 границы точно также зависят разрядности платформы
  (соответственно 0…2<sup>32</sup>−1 или 0…2<sup>64</sup>−1), но при
  переполнении ошибки сформировано не будет, будет сформирован токен
  с неопределённым значением.


    <ScanString-FromPos t.InitPos e.String> == e.Tokens
    t.InitPos ::= t.Pos

Разбивает строку на токены, начальной позицией принимается `t.InitPos`.


Синтаксический анализатор для Рефала-5
--------------------------------------

    <Parse e.Tokens>
      == Success e.Refal5-AST
      == Fails t.Error*

    t.Error ::= (t.SrcPos e.Message)

Функция `Parse` принимает последовательность токенов и возвращает абстрактное
синтаксическое дерево. Типы `t.Token` и `e.Refal5-AST` описаны
в [`R5FW-Parser-Defs`](R5FW-Parser-Defs.md).

Если файл содержит корректный текст на Рефале, функция возвращает `Success`
и синтаксическое дерево. Иначе функция возвращает `Fails` и список ошибок.
Таким образом, возвращаемое дерево всегда соответствует корректной программе.

К позициям токенов парсер относится как к чёрному ящику, внутрь `t.SrcPos`
не заглядывает.

* `t.Error` — сообщение о синтаксической или семантической ошибке.

